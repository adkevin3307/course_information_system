<!DOCTYPE HTML>
<!--
	Hielo by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<script>
	//$(function () {
	//	$('#bu').click(function () {
	//		$('html,body').animate({scrollTop: $('#One').offset().top}, 800);
	//	});
	//});

	function search()
	{
		var course_id = $('#course_id').val();
		var course_name = $('#course_name').val();
		var faculty_name = $('#faculty_name').val();
		var professor = $('#professor').val();
		var schedule = $('#schedule').val();
		var main_field = $('#main_field').val();
		var sub_field = $('#sub_field').val();
		var classroom = $('#classroom').val();
		var grade = $('#grade').val();
		var category = $('#category').val();
		var description = $('#description').val();
		
		
		$.ajax({
        url: "https://cis.ntouo.tw/api/courses?course_id="+course_id+"&course_name="+course_name+"&faculty_name="+faculty_name+"&professor="+professor+"&schedule="+schedule+"&main_field="+main_field+"&sub_field="+sub_field+"&classroom="+classroom+"&grade="+grade+"&category="+category+"&description="+description+"",
        type: "get",
        async: false,
        success: function(response){
            course_infos = response;
        }
    });
	
	$('#search_results').append(
		"<section id='one' class='wrapper style2'>"+
				"<div class='inner'>"+
					"<div id = 'outputclass' class='grid-style'>"+
						
					"</div>"+
				"</div>"+
		"</section>"
	);
	for(j = 0; j < course_infos.length; j++)
	{
		$('#outputclass').append(
			"<div>"+
				"<div class='box'>"+
					"<div class='content'>"+
						"<header class='align-center'>"+
							"<p>"+course_infos[j].main_field+"</p>"+
							"<h2>"+course_infos[j].course_name+"</h2>"+
						"</header>"+
						"<footer class='align-center'>"+
							"<a href='#generic.html?course_id="+course_infos[j].course_id+"&grade="+course_infos[j].grade+"' class='button alt' id = 'accordionExample'>詳細資訊</a>"+
						"</footer>"+
					"</div>"+
				"</div>"+
			"</div>"
		);
	
	}
	

	$(document).ready(function () {

		var url = "/ShowHistoryOrderServlet"; // test url
		$.ajax({
			url: url,
			type: "GET",
			async: true,
			dataType: "json",
			contentType: 'application/json; charset=UTF-8',
			success: function (data) {
			    console.log(data);
				var data_length = data.length;           //現在有多少訂單
				for (var i = 0; i < data_length; i++) {
					var customer = data[i].Customer;
					var customerID = customer.User_Id;
					var customerName = customer.User_Name;
					var customerAccount = customer.Account;
					var customerAddress = customer.Address;
					var customerOther = customer.Other;
					var customerPhoneNumber = customer.Phone_Number;

					$('#accordionExample').append(
							"<div class = 'card' >" +
							"<div class = 'card-header' id = 'headingOne' >" +
							"<h2 class = 'mb-0' >" +
							"<button id='collapseButton" + i + "' class = 'btn btn-link' type = 'button' data-toggle = 'collapse' data-target = '#"
							+ i + "' aria-expanded = 'true' aria-controls = '" + i
							+ "' >訂單編號:" + orderID + "&emsp;&emsp;食客帳號:" + customerAccount + "&emsp;&emsp;外送員帳號:" + deliverAccount + "</button>" +
							"</h2>" +
							"</div>" +
							"<div id = '" + i
							+ "' class = 'collapse' aria-labelledby = 'headingOne' data-parent = '#accordionExample'>"
							+     //第一個ID
							"<div class = 'card-body' >" +
							"<button type = 'button' class = 'btn btn-primary' data-toggle = 'modal' data-target = '#customer" + i + "'> 食客資訊 </button> "
							+
							"<div class = 'modal fade' id = 'customer" + i + "' tabindex = '-1' role = 'dialog' aria-labelledby = 'exampleModalCenterTitle' aria-hidden = 'true'>"
							+
							"<div class= 'modal-dialog modal-dialog-centered' role = 'document' >" +
							"<div class= 'modal-content' >" +
							"<div class = 'modal-header' >" +
							"<h5 class = 'modal-title' id = 'exampleModalCenterTitle' > 食客資訊 </h5>" +
							"<button type = 'button' class= 'close' data-dismiss = 'modal' aria-label = 'Close' >" +
							"<span aria-hidden = 'true' >&times;</span>" +
							"</button>" +
							"</div>" +
							"<div class = 'modal-body' style = 'text-align:left;'>食客ID:" + customerID + "<br >食客名字:" + customerName + "<br >食客帳號:" + customerAccount + "<br >食客地址:" + customerAddress + "<br >食客備註:" + customerOther + "<br >食客電話:" + customerPhoneNumber + "</div>"
							+
							"<div class= 'modal-footer' >" +
							"<button type = 'button' class= 'btn btn-secondary' data-dismiss = 'modal' >Close</button>"
							+
							"</div>" +
							"</div>" +
							"</div>" +
							"</div>" +
							"<button type = 'button' class= 'btn btn-primary' data-toggle = 'modal' data-target = '#deliver" + i + "' > 外送員資訊 </button> "
							+
							"<div class= 'modal fade' id = 'deliver" + i + "' tabindex = '-1' role = 'dialog' aria-labelledby = 'exampleModalCenterTitle' aria-hidden = 'true' >"
							+
							"<div class= 'modal-dialog modal-dialog-centered' role = 'document' >" +
							"<div class= 'modal-content' >" +
							"<div class= 'modal-header' >" +
							"<h5 class= 'modal-title' id = 'exampleModalCenterTitle' >外送員資訊</h5>" +
							"<button type = 'button' class= 'close' data-dismiss = 'modal' aria-label = 'Close' >" +
							"<span aria-hidden = 'true'>&times;</span>" +
							"</button>" +
							"</div>" +
							"<div class = 'modal-body' style = 'text-align:left;'>外送員ID:" + deliverID + "<br>外送員名字:" + deliverName + "<br >外送員帳號:" + deliverAccount + "<br >外送員電話:" + deliverPhoneNumber + "<br ></div>" +
							"<div class= 'modal-footer' >" +
							"<button type = 'button' class='btn btn-secondary' data-dismiss ='modal' >Close</button>"
							+
							"</div>" +
							"</div>" +
							"</div>" +
							"</div>" +
							"<button type = 'button' class= 'btn btn-primary' data-toggle = 'modal' data-target = '#order" + i + "' > 訂單資訊 </button>"
							+
							"<div class= 'modal fade' id = 'order" + i + "' tabindex = '-1' role = 'dialog' aria-labelledby = 'exampleModalCenterTitle' aria-hidden = 'true' >"
							+
							"<div class= 'modal-dialog modal-dialog-centered' role = 'document' >" +
							"<div class= 'modal-content' >" +
							"<div class= 'modal-header' >" +
							"<h5 class= 'modal-title' id = 'exampleModalCenterTitle' >訂單資訊</h5>" +
							"<button type = 'button' class= 'close' data-dismiss = 'modal' aria-label = 'Close' >" +
							"<span aria-hidden = 'true' >&times;</span>" +
							"</button>" +
							"</div>" +
							"<div id = '"+id2+"' class= 'modal-body' style = 'text-align:left;'>訂單總價:" + total + "<br >訂單種類:" + typeCount + "<br>" + "訂單起始時間:"+startTime+"<br >訂單狀態:"+orderStatus+"<br >訂單權重:"+castingPrio+"<br>"
					);


					// const buttonCustomer = "#customer"+i;
					// $(buttonCustomer).click(function () {
					//
					// }
					// const buttonDeliver = "#deliver"+i;
					// $(buttonDeliver).click(function () {
					//
					// }
					// const buttonOrder = "#order"+i;
					// $(buttonOrder).click(function () {
					//
					// }

                    var targetId2 = "#"+id2;
					var meal = order.Meals;
					for (var j = 0; j < meal.length; j++) {
						var restName = meal[j].Rest_Name;
						var restAddress = meal[j].Rest_Address;
						var foodID = meal[j].Food_Id;
						var foodName = meal[j].Food_Name;
						var cost = meal[j].Cost;
						var count = meal[j].Count;
						$(targetId2).append("<br>" +
								"餐廳名稱:" + restName + "<br >餐廳地址:" + restAddress + "<br >食物名稱:" + foodName + "<br >食物編號:" + foodID + "<br >食物單價:" + cost + "<br >食物個數:" + count + "<br >"
						);

					}

					$(targetId2).append("" +
							"</div>"
							+
							"<div class = 'modal-footer' >" +
							"<button type = 'button' class= 'btn btn-secondary' data-dismiss = 'modal' >Close</button>"
							+
							"</div>" +
							"</div>" +
							"</div>" +
							"</div>" +
							"</div>" +
							"</div>" +
							"</div>"
					);
					//  加監聽 <!--監聽按鈕 實施.collapse('toggle')-->
					var buttonTarget = "#collapseButton" + i;
					$(buttonTarget).click(function () {
						var target = "#" + this.id.split('collapseButton')[1];
						$(target).collapse('toggle')
					});
				}
			},
			error: function () {

			}
		});


	});

</script>
	<head>
		<title>海洋大學選課系統</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body>

		<!-- Header -->
			<header id="header" class="alt">
				<div class="logo"><a href="index.html">Hielo <span>by TEMPLATED</span></a></div>
				<a href="#menu">Menu</a>
			</header>

		<!-- Nav -->
			<nav id="menu">
				<ul class="links">
					<li><a href="index.html">Home</a></li>
					<li><a href="generic.html">Generic</a></li>
					<li><a href="elements.html">Elements</a></li>
				</ul>
			</nav>
			
		<!-- 最頂端的跑馬燈 -->
		<!-- Banner -->
			<section class="banner full">
				<article>
					<img src="images/slide01.jpg" alt="" />
					<div class="inner">
						<header>
							<p>歡迎使用 <a href="https://templated.co">選課系統</a></p>
							<h2>海洋大學選課系統</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/slide02.jpg" alt="" />
					<div class="inner">
						<header>
							<p>你能夠透過下方的選項去選擇出你想查詢的課程</p>
							<h2>新增</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/slide03.jpg"  alt="" />
					<div class="inner">
						<header>
							<p>你所蒐尋的課程將會呈現於網頁的下方</p>
							<h2>清單</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/slide04.jpg"  alt="" />
					<div class="inner">
						<header>
							<p>你能夠透過點選課程的詳細資訊去得到更多的課程資訊亦或是修改他</p>
							<h2>詳細資訊</h2>
						</header>
					</div>
				</article>
				<article>
					<img src="images/slide05.jpg"  alt="" />
					<div class="inner">
						<header>
							<p>你能夠在課程清單裡去新增你對這堂課程的留言亦或是察看他人對這堂課的留言</p>
							<h2>留言功能</h2>
						</header>
					</div>
				</article>
			</section>

			
		<!-- 搜尋選項 -->
		<!-- 課程名稱(中英文)  開課系所  授課教師  上課時段  主領域  子領域  上課地點  開課年級  備註  選課類別  克號(單一查詢) -->
		<!-- Three -->
			<section id="three" class="wrapper style2">
				<div class="inner">
					<header class="align-center">
						<p class="special">你能夠依據你所喜歡的選項去選擇<br>
						找出你所想要找尋的課程</p>
						<h2>搜尋選項</h2>
					</header>
					<div class="align-center">
					<div>
						<div>
							<p class = "word">課號</p>
							<input id="course_id" type="text"/>
						</div>
					</div>
					</div>
					<div class=" gallery">
					
						<div>
							<p class = "word">課程名稱</p>
							<input id="course_name" type="text"/>
						</div>
					
						<div>
							<p class = "word">開課系所</p>
							<select id='faculty_name'>
							</select>
						</div>
					</div>
					<div class=" gallery">	
						<div>
							<p class = "word">授課教師</p>
							<select id='professor'>
							</select>
						</div>
						<div>
							<p class = "word">上課時段</p>
							<select id='schedule'>
							</select>
						</div>
					</div>
					<div class=" gallery">
						<div>
							<p class = "word">主領域</p>
							<select id='main_field'>
							</select>
						</div>
						
						<div>
							<p class = "word">子領域</p>
							<select id='sub_field'>
							</select>
						</div>
					</div>
					<div class=" gallery">	
						<div>
							<p class = "word">上課地點</p>
							<select id='classroom'>
							</select>
						</div>
						
						<div>
							<p class = "word">開課年級</p>
							<select id='grade'>
							</select>
						</div>
					</div>
					<div class=" gallery">	
						<div>
							<p class = "word">備註</p>
							<input id="description" type="text"/>
						</div>
						
						<div>
							<p class = "word">選課類別</p>
							<select id='category'>
							</select>
						</div>
					</div>
					
					<ul align="center"class="actions">
						<br>
						<li><a href="javascript:search()" class="button special">搜尋</a></li>
					</ul>
					
				</div>
			</section>	

		<!-- 小段黑色地帶 -->
		<!-- Two -->
			<section id="two" class="wrapper style3">
				<div class="inner">
					<header class="align-center">
						<p>在你選好想要搜尋的選項後按下搜尋<br>
						我們會將結果顯示在下方</p>
						<h2>搜尋結果</h2>
					</header>
				</div>
			</section>

		<!-- 清單 -->	
		<div id ="search_results">
		</div>
		<!-- One
			<section id="one" class="wrapper style2">
				<div class="inner">
					<div class="grid-style">

						<div>
							<div class="box">
								<!-- <div class="image fit">
									<img src="images/pic02.jpg" alt="" />
								</div>
								<div class="content">
									<header class="align-center">
										<p>通識課</p>
										<h2>優質企業人</h2>
									</header>
									<footer class="align-center">
										<a href="#" class="button alt" id = "accordionExample">詳細資訊</a>
									</footer>
								</div>
							</div>
						</div>

						<div>
							<div class="box">
								<div class="content">
									<header class="align-center">
										<p>通識課</p>
										<h2>卓越大師</h2>
									</header>
									<footer class="align-center">
										<a href="#" class="button alt">詳細資訊</a>
									</footer>
								</div>
							</div>
						</div>

					</div>
				</div>
			</section>
		-->
			


		<!-- Footer -->
			<footer id="footer">
				<div class="container">
					<ul class="icons">
						<li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
					</ul>
				</div>
				<div class="copyright">
					&copy; Untitled. All rights reserved.
				</div>
			</footer>
		<!-- Scripts -->
	</body>
</html>